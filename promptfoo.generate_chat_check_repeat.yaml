configVersion: 1
providers:
  - id: openai:gpt-4o-mini
    config:
      temperature: 0.0
prompts:
  - file: generative_agents/data/prompts/generate_chat_check_repeat.txt

vars:
  agent: "Police"
  conversation: "Police: Our briefing starts at 3 pm.\nCoordinator: Okay, confirmed for 3 pm."
  content: "Police: Our briefing starts at 3 pm."

scenarios:
  - name: Obvious repetition - expect "Yes"
    vars:
      content: "Police: Our briefing starts at 3 pm."
  - name: Non-repetition - expect "No"
    vars:
      content: "Police: We should arrive 10 minutes early."

assertions:
  - type: javascript
    code: |
      const out = output.trim();
      const ok = out === "Yes" || out === "No";
      return ok ? true : { pass: false, reason: 'Output must be "Yes" or "No"' };
  - type: javascript
    code: |
      const out = output.trim();
      const isRepeatScenario = vars.content.includes("3 pm");
      if (isRepeatScenario && out !== "Yes") return { pass: false, reason: 'Repetition scenario should be "Yes"' };
      if (!isRepeatScenario && out !== "No") return { pass: false, reason: 'Non-repetition scenario should be "No"' };
      return true;